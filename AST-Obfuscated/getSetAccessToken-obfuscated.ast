[{"type":"Keyword","value":"var"},{"type":"Identifier","value":"_0xeb7d"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"["},{"type":"String","value":"'No\\x20token\\x20found'"},{"type":"Punctuator","value":","},{"type":"String","value":"'Invalid\\x20token'"},{"type":"Punctuator","value":","},{"type":"String","value":"'Token\\x20timed\\x20out'"},{"type":"Punctuator","value":","},{"type":"String","value":"'X-fcc-access-token'"},{"type":"Punctuator","value":","},{"type":"String","value":"'jwt_access_token'"},{"type":"Punctuator","value":","},{"type":"String","value":"'signedCookies'"},{"type":"Punctuator","value":","},{"type":"String","value":"'env'"},{"type":"Punctuator","value":","},{"type":"String","value":"'COOKIE_DOMAIN'"},{"type":"Punctuator","value":","},{"type":"String","value":"'localhost'"},{"type":"Punctuator","value":","},{"type":"String","value":"'cookie'"},{"type":"Punctuator","value":","},{"type":"String","value":"'headers'"},{"type":"Punctuator","value":","},{"type":"String","value":"'noTokenFound'"},{"type":"Punctuator","value":","},{"type":"String","value":"'invalidToken'"},{"type":"Punctuator","value":","},{"type":"String","value":"'now'"},{"type":"Punctuator","value":","},{"type":"String","value":"'expiredToken'"},{"type":"Punctuator","value":","},{"type":"String","value":"'clearCookie'"},{"type":"Punctuator","value":","},{"type":"String","value":"'userId'"},{"type":"Punctuator","value":","},{"type":"String","value":"'_csrf'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_0x55db6a"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"_0x144f36"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"_0x5360b3"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_0xf069e7"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"while"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"--"},{"type":"Identifier","value":"_0xf069e7"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"_0x55db6a"},{"type":"Punctuator","value":"["},{"type":"String","value":"'push'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_0x55db6a"},{"type":"Punctuator","value":"["},{"type":"String","value":"'shift'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"_0x5360b3"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"++"},{"type":"Identifier","value":"_0x144f36"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_0xeb7d"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x159"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_0x26ce89"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"_0x1dc49c"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"_0x26ce89"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_0x26ce89"},{"type":"Punctuator","value":"-"},{"type":"Numeric","value":"0x0"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"_0x1800b2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_0xeb7d"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x26ce89"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"_0x1800b2"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"import"},{"type":"Identifier","value":"_0x1f5170"},{"type":"Identifier","value":"from"},{"type":"String","value":"'jsonwebtoken'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"import"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"isBefore"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"from"},{"type":"String","value":"'date-fns'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"import"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"jwtSecret"},{"type":"Identifier","value":"as"},{"type":"Identifier","value":"_0x5a4c4f"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"from"},{"type":"String","value":"'../../../config/secrets'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"export"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"authHeaderNS"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x0'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"export"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"jwtCookieNS"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"export"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"createCookieConfig"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Punctuator","value":"{"},{"type":"String","value":"'signed'"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"!"},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x2'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":","},{"type":"String","value":"'domain'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"process"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x3'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x4'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"||"},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x5'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"export"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"setAccessTokenToResponse"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"accessToken"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"jwtSecret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_0x5a4c4f"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cookieConfig"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"..."},{"type":"Identifier","value":"createCookieConfig"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"String","value":"'maxAge'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"accessToken"},{"type":"Punctuator","value":"["},{"type":"String","value":"'ttl'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"||"},{"type":"Numeric","value":"0x121adb7000"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"jwtAccess"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_0x1f5170"},{"type":"Punctuator","value":"["},{"type":"String","value":"'sign'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"String","value":"'accessToken'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"accessToken"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"jwtSecret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x6'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"jwtCookieNS"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"jwtAccess"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cookieConfig"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"export"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"getAccessTokenFromRequest"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"jwtSecret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_0x5a4c4f"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"maybeToken"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":"["},{"type":"String","value":"'headers'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x7'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"authHeaderNS"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"||"},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":"["},{"type":"String","value":"'signedCookies'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":"["},{"type":"String","value":"'signedCookies'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"jwtCookieNS"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"||"},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":"["},{"type":"String","value":"'cookie'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x6'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"jwtCookieNS"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"maybeToken"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Punctuator","value":"{"},{"type":"String","value":"'accessToken'"},{"type":"Punctuator","value":":"},{"type":"Null","value":"null"},{"type":"Punctuator","value":","},{"type":"String","value":"'error'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"errorTypes"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x8'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"token"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"try"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"token"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_0x1f5170"},{"type":"Punctuator","value":"["},{"type":"String","value":"'verify'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"maybeToken"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"jwtSecret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"catch"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_0x389265"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Punctuator","value":"{"},{"type":"String","value":"'accessToken'"},{"type":"Punctuator","value":":"},{"type":"Null","value":"null"},{"type":"Punctuator","value":","},{"type":"String","value":"'error'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"errorTypes"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x9'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"accessToken"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"token"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"created"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ttl"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"accessToken"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"valid"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"isBefore"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"Date"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0xa'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"Date"},{"type":"Punctuator","value":"["},{"type":"String","value":"'parse'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"created"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"ttl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"valid"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Punctuator","value":"{"},{"type":"String","value":"'accessToken'"},{"type":"Punctuator","value":":"},{"type":"Null","value":"null"},{"type":"Punctuator","value":","},{"type":"String","value":"'error'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"errorTypes"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0xb'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"return"},{"type":"Punctuator","value":"{"},{"type":"String","value":"'accessToken'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"accessToken"},{"type":"Punctuator","value":","},{"type":"String","value":"'error'"},{"type":"Punctuator","value":":"},{"type":"String","value":"''"},{"type":"Punctuator","value":","},{"type":"String","value":"'jwt'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"maybeToken"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"export"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"removeCookies"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"config"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"createCookieConfig"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"req"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"["},{"type":"String","value":"'clearCookie'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"jwtCookieNS"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"config"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"["},{"type":"String","value":"'clearCookie'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"String","value":"'access_token'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"config"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0xc'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0xd'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"config"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0xc'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0xe'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"config"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"export"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"errorTypes"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"String","value":"'noTokenFound'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0xf'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"String","value":"'invalidToken'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x10'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"String","value":"'expiredToken'"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"_0x3f19"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0x11'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"}]
[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hasCrypto"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"skip"},{"type":"Punctuator","value":"("},{"type":"String","value":"'missing crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"expectWarning"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"DeprecationWarning"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"["},{"type":"String","value":"'crypto.createCipher is deprecated.'"},{"type":"Punctuator","value":","},{"type":"String","value":"'DEP0106'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'assert'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'tls'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common/fixtures'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"certPfx"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_cert.pfx'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"credentials"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSecureContext"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"credentials"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"notcontext"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"setOptions"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setOptions"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"notcontext"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setOptions"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"RegularExpression","value":"/^TypeError: Illegal invocation$/","regex":{"pattern":"^TypeError: Illegal invocation$","flags":""}},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSecureContext"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"pfx"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"certPfx"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'sample'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSecureContext"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"pfx"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"certPfx"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"RegularExpression","value":"/^Error: mac verify failure$/","regex":{"pattern":"^Error: mac verify failure$","flags":""}},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSecureContext"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"pfx"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"certPfx"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'test'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"RegularExpression","value":"/^Error: mac verify failure$/","regex":{"pattern":"^Error: mac verify failure$","flags":""}},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSecureContext"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"pfx"},{"type":"Punctuator","value":":"},{"type":"String","value":"'sample'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'test'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"RegularExpression","value":"/^Error: not enough data$/","regex":{"pattern":"^Error: not enough data$","flags":""}},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"expectsError"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createHash"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"foo"},{"type":"Punctuator","value":":"},{"type":"String","value":"'bar'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"code"},{"type":"Punctuator","value":":"},{"type":"String","value":"'ERR_INVALID_ARG_TYPE'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"TypeError"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"validateList"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":">"},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sorted"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"..."},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sort"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"sorted"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"..."},{"type":"Keyword","value":"new"},{"type":"Identifier","value":"Set"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"every"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"value"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Keyword","value":"typeof"},{"type":"Identifier","value":"value"},{"type":"Punctuator","value":"==="},{"type":"String","value":"'string'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cryptoCiphers"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCiphers"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCiphers"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'aes-128-cbc'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"validateList"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cryptoCiphers"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"tlsCiphers"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCiphers"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCiphers"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'aes256-sha'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCiphers"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'tls_aes_128_ccm_8_sha256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"noCapitals"},{"type":"Punctuator","value":"="},{"type":"RegularExpression","value":"/^[^A-Z]+$/","regex":{"pattern":"^[^A-Z]+$","flags":""}},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"tlsCiphers"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"every"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"value"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Identifier","value":"noCapitals"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"value"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"validateList"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"tlsCiphers"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"notStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'RSA-SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'rsa-sha1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"validateList"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"notStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCurves"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCurves"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'secp384r1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCurves"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SECP384R1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"validateList"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCurves"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"testImmutability"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"fn"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fn"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"copy"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"..."},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"list"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"push"},{"type":"Punctuator","value":"("},{"type":"String","value":"'some-arbitrary-value'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"fn"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"copy"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"testImmutability"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCiphers"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testImmutability"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCiphers"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testImmutability"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testImmutability"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCurves"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createCipher"},{"type":"Punctuator","value":"("},{"type":"String","value":"'aes192'"},{"type":"Punctuator","value":","},{"type":"String","value":"'test'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"errorMessage"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hasFipsCrypto"},{"type":"Punctuator","value":"?"},{"type":"RegularExpression","value":"/not supported in FIPS mode/","regex":{"pattern":"not supported in FIPS mode","flags":""}},{"type":"Punctuator","value":":"},{"type":"RegularExpression","value":"/Bad input string/","regex":{"pattern":"Bad input string","flags":""}},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"errorMessage"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDecipher"},{"type":"Punctuator","value":"("},{"type":"String","value":"'aes192'"},{"type":"Punctuator","value":","},{"type":"String","value":"'test'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"errorMessage"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hasFipsCrypto"},{"type":"Punctuator","value":"?"},{"type":"RegularExpression","value":"/not supported in FIPS mode/","regex":{"pattern":"not supported in FIPS mode","flags":""}},{"type":"Punctuator","value":":"},{"type":"RegularExpression","value":"/Bad input string/","regex":{"pattern":"Bad input string","flags":""}},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"errorMessage"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createHash"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"RegularExpression","value":"/^TypeError: Bad input string$/","regex":{"pattern":"^TypeError: Bad input string$","flags":""}},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"priv"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"["},{"type":"String","value":"'-----BEGIN RSA PRIVATE KEY-----'"},{"type":"Punctuator","value":","},{"type":"String","value":"'MIGrAgEAAiEA+3z+1QNF2/unumadiwEr+C5vfhezsb3hp4jAnCNRpPcCAwEAAQIgQNriSQK4'"},{"type":"Punctuator","value":","},{"type":"String","value":"'EFwczDhMZp2dvbcz7OUUyt36z3S4usFPHSECEQD/41K7SujrstBfoCPzwC1xAhEA+5kt4BJy'"},{"type":"Punctuator","value":","},{"type":"String","value":"'eKN7LggbF3Dk5wIQN6SL+fQ5H/+7NgARsVBp0QIRANxYRukavs4QvuyNhMx+vrkCEQCbf6j/'"},{"type":"Punctuator","value":","},{"type":"String","value":"'Ig6/HueCK/0Jkmp+'"},{"type":"Punctuator","value":","},{"type":"String","value":"'-----END RSA PRIVATE KEY-----'"},{"type":"Punctuator","value":","},{"type":"String","value":"''"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"join"},{"type":"Punctuator","value":"("},{"type":"String","value":"'\\n'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"priv"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"RegularExpression","value":"/digest too big for rsa key$/","regex":{"pattern":"digest too big for rsa key$","flags":""}},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sha1_privateKey"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_bad_rsa_privkey.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sha1_privateKey"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"RegularExpression","value":"/asn1 encoding routines:[^:]*:wrong tag/","regex":{"pattern":"asn1 encoding routines:[^:]*:wrong tag","flags":""}},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"!=="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"Array"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"isArray"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":">"},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"console"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"log"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"randomBytes"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"16"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSecureContext"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"crl"},{"type":"Punctuator","value":":"},{"type":"String","value":"'not a CRL'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"RegularExpression","value":"/^Error: Failed to parse CRL$/","regex":{"pattern":"^Error: Failed to parse CRL$","flags":""}},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"test"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"opensslErrorStack"},{"type":"Punctuator","value":"==="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"testEncoding"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"assertionHash"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"hash"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createHash"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha256'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"hashValue"},{"type":"Punctuator","value":"="},{"type":"String","value":"''"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hash"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'data'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"data"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"hashValue"},{"type":"Punctuator","value":"+="},{"type":"Identifier","value":"data"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hash"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'end'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"mustCall"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"hashValue"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"assertionHash"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hash"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"write"},{"type":"Punctuator","value":"("},{"type":"String","value":"'öäü'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hash"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"end"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"assertionHashUtf8"},{"type":"Punctuator","value":"="},{"type":"String","value":"'4f53d15bee524f082380e6d7247cc541e7cb0d10c64efdcc935ceeb1e7ea345c'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"assertionHashLatin1"},{"type":"Punctuator","value":"="},{"type":"String","value":"'cd37bccd5786e2e76d9b18c871e919e6eb11cc12d868f5ae41c40ccff8e44830'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testEncoding"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"assertionHashUtf8"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testEncoding"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"assertionHashUtf8"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testEncoding"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"defaultEncoding"},{"type":"Punctuator","value":":"},{"type":"String","value":"'utf8'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"assertionHashUtf8"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testEncoding"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"defaultEncoding"},{"type":"Punctuator","value":":"},{"type":"String","value":"'latin1'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"assertionHashLatin1"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"}]
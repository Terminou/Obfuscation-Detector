[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"describe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'urlUtils'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"describe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'urlResolve'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should returned already parsed URLs unchanged'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"urlObj"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'/foo?bar=baz#qux'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlObj"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlObj"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"Null","value":"null"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeUndefined"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should normalize a relative url'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"href"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toMatch"},{"type":"Punctuator","value":"("},{"type":"RegularExpression","value":"/^https?:\\/\\/[^/]+\\/foo$/","regex":{"pattern":"^https?:\\/\\/[^/]+\\/foo$","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should parse relative URL into component pieces'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"href"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toMatch"},{"type":"Punctuator","value":"("},{"type":"RegularExpression","value":"/https?:\\/\\//","regex":{"pattern":"https?:\\/\\/","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"protocol"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toMatch"},{"type":"Punctuator","value":"("},{"type":"RegularExpression","value":"/^https?/","regex":{"pattern":"^https?","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"host"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"not"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"''"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hostname"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"not"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"''"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"pathname"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"not"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"''"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should return pathname as / if empty path provided'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'/'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"pathname"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'/'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should return an IPv6 hostname wrapped in brackets'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'http://[::1]/'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hostname"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'[::1]'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should not put the domain in brackets for the hostname field'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'https://google.com/'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hostname"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'google.com'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"describe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'urlIsSameOrigin and urlIsSameOriginAsBaseUrl'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should support various combinations of urls - both string and parsed'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"inject"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"$document"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"expectIsSameOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"expectedValue"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsSameOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expectedValue"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsSameOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expectedValue"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsSameOriginAsBaseUrl"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expectedValue"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsSameOriginAsBaseUrl"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expectedValue"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"expectIsSameOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'path'"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"$document"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"location"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"href"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expectIsSameOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'//'"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"host"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'/path'"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expectIsSameOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'http://example.com/path'"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expectIsSameOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'//example.com/path'"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expectIsSameOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'//'"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hostname"},{"type":"Punctuator","value":"+"},{"type":"String","value":"':22/path'"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"describe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'urlIsAllowedOriginFactory'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"window"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"location"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"href"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"beforeEach"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"urlIsAllowedOriginFactory"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"String","value":"'https://foo.com/'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"protocol"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'://bar.com:1337/'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should implicitly allow the current origin'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should check against the list of whitelisted origins'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'https://foo.com/path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"protocol"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'://bar.com:1337/path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'https://baz.com:1337/path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'https://qux.com/path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should support both strings and parsed URL objects'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"String","value":"'https://foo.com/path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlResolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'https://foo.com/path'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should return true only if the origins (protocol, hostname, post) match'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"differentProtocol"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"protocol"},{"type":"Punctuator","value":"!=="},{"type":"String","value":"'http'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"?"},{"type":"String","value":"'http'"},{"type":"Punctuator","value":":"},{"type":"String","value":"'https'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"differentPort"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"parseInt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"port"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"10"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"||"},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"+"},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"String","value":"'path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"protocol"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'://'"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"host"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'/path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"String","value":"'//'"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"host"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'/path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"differentProtocol"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'://'"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"host"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'/path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"protocol"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'://'"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hostname"},{"type":"Punctuator","value":"+"},{"type":"String","value":"':'"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"differentPort"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'/path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"protocol"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'://bar.com:1337/path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"String","value":"'//bar.com:1337/path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"differentProtocol"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'://bar.com:1337/path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"origin"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"protocol"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'://bar.com:1338/path'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"urlIsAllowedOrigin"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"}]
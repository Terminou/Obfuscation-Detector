[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dnstools"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common/dns'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dns"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'dns'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'assert'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dgram"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'dgram'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dnsPromises"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dns"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"promises"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"answers"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"String","value":"'A'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"address"},{"type":"Punctuator","value":":"},{"type":"String","value":"'1.2.3.4'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ttl"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"123"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"String","value":"'AAAA'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"address"},{"type":"Punctuator","value":":"},{"type":"String","value":"'::42'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ttl"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"123"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"String","value":"'MX'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"priority"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"42"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"exchange"},{"type":"Punctuator","value":":"},{"type":"String","value":"'foobar.com'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ttl"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"124"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"String","value":"'NS'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"value"},{"type":"Punctuator","value":":"},{"type":"String","value":"'foobar.org'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ttl"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"457"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"String","value":"'TXT'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"entries"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"["},{"type":"String","value":"'v=spf1 ~all'"},{"type":"Punctuator","value":","},{"type":"String","value":"'xyz'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"String","value":"'PTR'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"value"},{"type":"Punctuator","value":":"},{"type":"String","value":"'baz.org'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ttl"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"987"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"String","value":"'SOA'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"nsname"},{"type":"Punctuator","value":":"},{"type":"String","value":"'ns1.example.com'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"hostmaster"},{"type":"Punctuator","value":":"},{"type":"String","value":"'admin.example.com'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"serial"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"156696742"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"refresh"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"900"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"retry"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"900"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"expire"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"1800"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"minttl"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"60"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dgram"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSocket"},{"type":"Punctuator","value":"("},{"type":"String","value":"'udp4'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'message'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"mustCall"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"address"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"port"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dnstools"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"parseDNSPacket"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"domain"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"questions"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"domain"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"domain"},{"type":"Punctuator","value":","},{"type":"String","value":"'example.org'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"send"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dnstools"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"writeDNSPacket"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"id"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"id"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"questions"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"parsed"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"questions"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"answers"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"answers"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"map"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"answer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Identifier","value":"Object"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"assign"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"domain"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"answer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"port"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"address"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"bind"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"mustCall"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"async"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"address"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"address"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"dns"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setServers"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Template","value":"`127.0.0.1:${"},{"type":"Identifier","value":"address"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"port"},{"type":"Template","value":"}`"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"validateResults"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"await"},{"type":"Identifier","value":"dnsPromises"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"resolveAny"},{"type":"Punctuator","value":"("},{"type":"String","value":"'example.org'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"dns"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"resolveAny"},{"type":"Punctuator","value":"("},{"type":"String","value":"'example.org'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"mustCall"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"ifError"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"validateResults"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"close"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"validateResults"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"map"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"maybeRedactTTL"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"answers"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"map"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"maybeRedactTTL"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"maybeRedactTTL"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"r"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ret"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"..."},{"type":"Identifier","value":"r"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Punctuator","value":"["},{"type":"String","value":"'A'"},{"type":"Punctuator","value":","},{"type":"String","value":"'AAAA'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"includes"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"r"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"delete"},{"type":"Identifier","value":"ret"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"ttl"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"ret"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"}]
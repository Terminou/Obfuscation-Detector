[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hasCrypto"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"skip"},{"type":"Punctuator","value":"("},{"type":"String","value":"'missing crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'assert'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"constants"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"constants"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common/fixtures'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"certPem"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_cert.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"keyPem"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_key.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_rsa_pubkey.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"rsaKeyPem"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_rsa_privkey.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_rsa_privkey_encrypted.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dsaPubPem"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_dsa_pubkey.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dsaKeyPem"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_dsa_privkey.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dsaKeyPemEncrypted"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_dsa_privkey_encrypted.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"decryptError"},{"type":"Punctuator","value":"="},{"type":"RegularExpression","value":"/^Error: error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad decrypt$/","regex":{"pattern":"^Error: error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad decrypt$","flags":""}},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":"="},{"type":"String","value":"'I AM THE WALRUS'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicEncrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateDecrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaKeyPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"decryptedBufferWithPassword"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateDecrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'password'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"decryptedBufferWithPassword"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicEncrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'password'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"decryptedBufferWithPassword"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateDecrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'password'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"decryptedBufferWithPassword"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateEncrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'password'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"decryptedBufferWithPassword"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicDecrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'password'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"decryptedBufferWithPassword"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicEncrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"certPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateDecrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"keyPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicEncrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"keyPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateDecrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"keyPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateEncrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"keyPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicDecrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"keyPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateDecrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'wrong'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"decryptError"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicEncrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'wrong'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"decryptError"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateEncrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'password'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicDecrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'wrong'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"decryptError"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"test_rsa"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":"==="},{"type":"String","value":"'RSA_NO_PADDING'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"?"},{"type":"Numeric","value":"1024"},{"type":"Punctuator","value":"/"},{"type":"Numeric","value":"8"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"32"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"allocUnsafe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"for"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"i"},{"type":"Punctuator","value":"="},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"i"},{"type":"Punctuator","value":"<"},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"i"},{"type":"Punctuator","value":"++"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"i"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"i"},{"type":"Punctuator","value":"*"},{"type":"Numeric","value":"7"},{"type":"Punctuator","value":"+"},{"type":"Numeric","value":"11"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&"},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"constants"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicEncrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bufferToEncrypt"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"privateDecrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encryptedBuffer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"decryptedBuffer"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"test_rsa"},{"type":"Punctuator","value":"("},{"type":"String","value":"'RSA_NO_PADDING'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"test_rsa"},{"type":"Punctuator","value":"("},{"type":"String","value":"'RSA_PKCS1_PADDING'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"test_rsa"},{"type":"Punctuator","value":"("},{"type":"String","value":"'RSA_PKCS1_OAEP_PADDING'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"rsaVerify"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createVerify"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"ok"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"ok"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaVerify"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"expectedSignature"},{"type":"Punctuator","value":"="},{"type":"String","value":"'5c50e3145c4e2497aadb0eabc83b342d0b0021ece0d4c4a064b7c'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'8f020d7e2688b122bfb54c724ac9ee169f83f66d2fe90abeb95e8'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'e1290e7e177152a4de3d944cf7d4883114a20ed0f78e70e25ef0f'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'60f06b858e6af42a2f276ede95bbc6bc9a9bbdda15bd663186a6f'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'40819a7af19e577bb2efa5e579a1f5ce8a0d4ca8b8f6'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"rsaSignature"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaKeyPem"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaSignature"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"expectedSignature"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaVerify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaVerify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"rsaSignature"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"signOptions"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'password'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaSignature"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"signOptions"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaSignature"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"expectedSignature"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaVerify"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createVerify"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaVerify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaVerify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"rsaSignature"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"rsaPubPem"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"signOptions"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"rsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'wrong'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"rsaSign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"signOptions"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"decryptError"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"privateKey"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_rsa_privkey_2.pem'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"publicKey"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test_rsa_pubkey_2.pem'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":"="},{"type":"String","value":"'I AM THE WALRUS'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":"="},{"type":"String","value":"'79d59d34f56d0e94aa6a3e306882b52ed4191f07521f25f505a078dc2f89'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'396e0c8ac89e996fde5717f4cb89199d8fec249961fcb07b74cd3d2a4ffa'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'235417b69618e4bcd76b97e29975b7ce862299410e1b522a328e44ac9bb2'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'8195e0268da7eda23d9825ac43c724e86ceeee0d0d4465678652ccaf6501'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'0ddfb299bedeb1ad'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"output"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"privateKey"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"output"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createVerify"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"publicKey"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sign2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'RSA-SHA256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"sign2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"output2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"sign2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"privateKey"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"output2"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"verify2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createVerify"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"verify2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"verify2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"publicKey"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":"="},{"type":"String","value":"'I AM THE WALRUS'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dsaKeyPem"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createVerify"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dsaPubPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sign2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'DSS1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"sign2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"signature2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"sign2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dsaKeyPem"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"verify2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createVerify"},{"type":"Punctuator","value":"("},{"type":"String","value":"'DSS1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"verify2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"verify2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dsaPubPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"signature2"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":"="},{"type":"String","value":"'I AM THE WALRUS'"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"dsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'wrong'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"decryptError"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"signOptions"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"dsaKeyPemEncrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"passphrase"},{"type":"Punctuator","value":":"},{"type":"String","value":"'password'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"signOptions"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createVerify"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verify"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dsaPubPem"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"signature"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"}]
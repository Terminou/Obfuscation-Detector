[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hasCrypto"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"skip"},{"type":"Punctuator","value":"("},{"type":"String","value":"'missing crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common/fixtures'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'tls'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"util"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'util'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"exports"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'assert'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"exports"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"debug"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"util"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"debuglog"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"exports"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"keys"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"exports"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"keys"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"agent1"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'agent1'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ca1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"agent2"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'agent2'"},{"type":"Punctuator","value":","},{"type":"String","value":"'agent2'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"agent3"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'agent3'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ca2'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"agent4"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'agent4'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ca2'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"agent5"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'agent5'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ca2'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"agent6"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'agent6'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ca1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"agent7"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'agent7'"},{"type":"Punctuator","value":","},{"type":"String","value":"'fake-cnnic-root'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"agent10"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'agent10'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ca2'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ec10"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'ec10'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ca5'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ec"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"String","value":"'ec'"},{"type":"Punctuator","value":","},{"type":"String","value":"'ec'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"load"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cert"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"root"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"root"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"root"},{"type":"Punctuator","value":"||"},{"type":"Identifier","value":"cert"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"id"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cert"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'-key.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'binary'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cert"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cert"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'-cert.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'binary'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ca"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"fixtures"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"root"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'-cert.pem'"},{"type":"Punctuator","value":","},{"type":"String","value":"'binary'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"id"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"exports"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"connect"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"connect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"mustCall"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"pair"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"try"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createServer"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"pipe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"maybeCallback"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"listen"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"optClient"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"util"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"_extend"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"port"},{"type":"Punctuator","value":":"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"address"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"port"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"try"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"tls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"connect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"optClient"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'secureConnect'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"maybeCallback"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"maybeCallback"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"catch"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"pair"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cleanup"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":"="},{"type":"Null","value":"null"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'tlsClientError'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"sock"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"sock"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"maybeCallback"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"catch"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"pair"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"pair"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"maybeCallback"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"return"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":"&&"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":"||"},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"pair"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"||"},{"type":"Identifier","value":"pair"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"pair"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cleanup"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"callback"},{"type":"Punctuator","value":"="},{"type":"Null","value":"null"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"cleanup"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"server"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"close"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"client"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"conn"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"end"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"}]
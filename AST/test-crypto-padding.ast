[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hasCrypto"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"skip"},{"type":"Punctuator","value":"("},{"type":"String","value":"'missing crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'assert'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ODD_LENGTH_PLAIN"},{"type":"Punctuator","value":"="},{"type":"String","value":"'Hello node world!'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"EVEN_LENGTH_PLAIN"},{"type":"Punctuator","value":"="},{"type":"String","value":"'Hello node world!AbC09876dDeFgHi'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"KEY_PLAIN"},{"type":"Punctuator","value":"="},{"type":"String","value":"'S3c.r.e.t.K.e.Y!'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"IV_PLAIN"},{"type":"Punctuator","value":"="},{"type":"String","value":"'blahFizz2011Buzz'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"CIPHER_NAME"},{"type":"Punctuator","value":"="},{"type":"String","value":"'aes-128-cbc'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ODD_LENGTH_ENCRYPTED"},{"type":"Punctuator","value":"="},{"type":"String","value":"'7f57859550d4d2fdb9806da2a750461a9fe77253cd1cbd4b07beee4e070d561f'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"EVEN_LENGTH_ENCRYPTED"},{"type":"Punctuator","value":"="},{"type":"String","value":"'7f57859550d4d2fdb9806da2a750461ab46e71b3d78ebe2d9684dfc87f7575b988'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'6119866912cb8c7bcaf76c5ebc2378'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"EVEN_LENGTH_ENCRYPTED_NOPAD"},{"type":"Punctuator","value":"="},{"type":"String","value":"'7f57859550d4d2fdb9806da2a750461ab46e71b3d78ebe2d9684dfc87f7575b9'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"enc"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"pad"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"encrypt"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createCipheriv"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"CIPHER_NAME"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"KEY_PLAIN"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"IV_PLAIN"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"encrypt"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setAutoPadding"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"pad"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"hex"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"encrypt"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":","},{"type":"String","value":"'ascii'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hex"},{"type":"Punctuator","value":"+="},{"type":"Identifier","value":"encrypt"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"final"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"hex"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"dec"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"encd"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"pad"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"decrypt"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDecipheriv"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"CIPHER_NAME"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"KEY_PLAIN"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"IV_PLAIN"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"decrypt"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setAutoPadding"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"pad"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"decrypt"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"encd"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":"+="},{"type":"Identifier","value":"decrypt"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"final"},{"type":"Punctuator","value":"("},{"type":"String","value":"'latin1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"enc"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ODD_LENGTH_PLAIN"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ODD_LENGTH_ENCRYPTED"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"enc"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"EVEN_LENGTH_PLAIN"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"EVEN_LENGTH_ENCRYPTED"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"enc"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ODD_LENGTH_PLAIN"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"RegularExpression","value":"/data not multiple of block length/","regex":{"pattern":"data not multiple of block length","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"enc"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"EVEN_LENGTH_PLAIN"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"EVEN_LENGTH_ENCRYPTED_NOPAD"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dec"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ODD_LENGTH_ENCRYPTED"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"ODD_LENGTH_PLAIN"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dec"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"EVEN_LENGTH_ENCRYPTED"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"EVEN_LENGTH_PLAIN"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dec"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ODD_LENGTH_ENCRYPTED"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"32"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dec"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"EVEN_LENGTH_ENCRYPTED"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"48"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dec"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"EVEN_LENGTH_ENCRYPTED_NOPAD"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"EVEN_LENGTH_PLAIN"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"RegularExpression","value":"/bad decrypt/","regex":{"pattern":"bad decrypt","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dec"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"EVEN_LENGTH_ENCRYPTED_NOPAD"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"EVEN_LENGTH_PLAIN"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"}]
[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../common'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hasCrypto"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"skip"},{"type":"Punctuator","value":"("},{"type":"String","value":"'missing crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'assert'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"constants"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"hasFipsCrypto"},{"type":"Punctuator","value":"?"},{"type":"Numeric","value":"1024"},{"type":"Punctuator","value":":"},{"type":"Numeric","value":"256"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"p1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrime"},{"type":"Punctuator","value":"("},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dh2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"p1"},{"type":"Punctuator","value":","},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"key1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"key2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dh2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"secret1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key2"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'base64'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"secret2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dh2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key1"},{"type":"Punctuator","value":","},{"type":"String","value":"'latin1'"},{"type":"Punctuator","value":","},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"secret2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'base64'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret1"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"DiffieHellman"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"DiffieHellman"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dh"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"DiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"p1"},{"type":"Punctuator","value":","},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"DiffieHellman"},{"type":"Punctuator","value":","},{"type":"String","value":"'DiffieHellman is expected to return a '"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'new instance when called without `new`'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"DiffieHellmanGroup"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"DiffieHellmanGroup"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dhg"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"DiffieHellmanGroup"},{"type":"Punctuator","value":"("},{"type":"String","value":"'modp5'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dhg"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"DiffieHellmanGroup"},{"type":"Punctuator","value":","},{"type":"String","value":"'DiffieHellmanGroup is expected '"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'to return a new instance when '"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'called without `new`'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ECDH"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"ECDH"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ecdh"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"ECDH"},{"type":"Punctuator","value":"("},{"type":"String","value":"'prime256v1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"ECDH"},{"type":"Punctuator","value":","},{"type":"String","value":"'ECDH is expected to return a new instance '"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'when called without `new`'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0x1"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x2"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"RegularExpression","value":"/abc/","regex":{"pattern":"abc","flags":""}},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"forEach"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"expectsError"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"input"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"code"},{"type":"Punctuator","value":":"},{"type":"String","value":"'ERR_INVALID_ARG_TYPE'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"TypeError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":":"},{"type":"String","value":"'The \"sizeOrKey\" argument must be one of type number, string, '"},{"type":"Punctuator","value":"+"},{"type":"Template","value":"`Buffer, TypedArray, or DataView. Received type ${"},{"type":"Keyword","value":"typeof"},{"type":"Identifier","value":"input"},{"type":"Template","value":"}`"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"p1"},{"type":"Punctuator","value":","},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"privkey1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPublicKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key1"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"privkey1"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrime"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrime"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getGenerator"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getGenerator"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"secret3"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key2"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'base64'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"secret1"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret3"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"dh4"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"p1"},{"type":"Punctuator","value":","},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"dh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"privkey1"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrime"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"dh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrime"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getGenerator"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"dh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getGenerator"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"deepStrictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"dh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"dh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"secret4"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"dh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key2"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'base64'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"secret1"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret4"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"wrongBlockLength"},{"type":"Punctuator","value":"="},{"type":"RegularExpression","value":"/^Error: error:0606506D:digital envelope routines:EVP_DecryptFinal_ex:wrong final block length$/","regex":{"pattern":"^Error: error:0606506D:digital envelope routines:EVP_DecryptFinal_ex:wrong final block length$","flags":""}},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"c"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDecipheriv"},{"type":"Punctuator","value":"("},{"type":"String","value":"'aes-128-ecb'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"randomBytes"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"16"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"String","value":"''"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"c"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"final"},{"type":"Punctuator","value":"("},{"type":"String","value":"'utf8'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"wrongBlockLength"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"c"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDecipheriv"},{"type":"Punctuator","value":"("},{"type":"String","value":"'aes-128-ecb'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"randomBytes"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"16"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"String","value":"''"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"c"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"final"},{"type":"Punctuator","value":"("},{"type":"String","value":"'utf8'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"wrongBlockLength"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"dh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"String","value":"''"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"RegularExpression","value":"/^Error: Supplied key is too small$/","regex":{"pattern":"^Error: Supplied key is too small$","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"alice"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellmanGroup"},{"type":"Punctuator","value":"("},{"type":"String","value":"'modp5'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellmanGroup"},{"type":"Punctuator","value":"("},{"type":"String","value":"'modp5'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"alice"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"aSecret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"alice"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"bSecret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"alice"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"aSecret"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bSecret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"alice"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellmanGroup"},{"type":"Punctuator","value":"("},{"type":"String","value":"'modp2'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"modp2buf"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xc9"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x0f"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xda"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xa2"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x21"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x68"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xc2"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x34"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xc4"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xc6"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x62"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x8b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x80"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xdc"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x1c"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xd1"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x29"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x02"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x4e"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x08"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x8a"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x67"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xcc"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x74"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x02"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x0b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xbe"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xa6"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x3b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x13"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x9b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x22"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x51"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x4a"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x08"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x79"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x8e"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x34"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x04"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xdd"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xef"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x95"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x19"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xb3"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xcd"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x3a"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x43"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x1b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x30"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x2b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x0a"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x6d"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xf2"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x5f"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x14"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x37"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x4f"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xe1"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x35"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x6d"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x6d"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x51"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xc2"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x45"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xe4"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x85"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xb5"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x76"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x62"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x5e"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x7e"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xc6"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xf4"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x4c"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x42"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xe9"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xa6"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x37"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xed"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x6b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x0b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x5c"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xb6"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xf4"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x06"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xb7"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xed"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xee"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x38"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x6b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xfb"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x5a"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x89"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x9f"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xa5"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xae"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x9f"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x24"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x11"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x7c"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x4b"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x1f"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xe6"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x49"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x28"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x66"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x51"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xec"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xe6"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x53"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0x81"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0xff"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2buf"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"modp2Secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"exmodp2Secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2Secret"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"exmodp2Secret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"for"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"buf"},{"type":"Identifier","value":"of"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"modp2buf"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"..."},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getArrayBufferViews"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2buf"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":","},{"type":"String","value":"'02'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"modp2Secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"exmodp2Secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2Secret"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"exmodp2Secret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2buf"},{"type":"Punctuator","value":","},{"type":"String","value":"'\\x02'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"modp2Secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"exmodp2Secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2Secret"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"exmodp2Secret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2buf"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"modp2Secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"exmodp2Secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"modp2Secret"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"exmodp2Secret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"exmodp2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"p"},{"type":"Punctuator","value":"="},{"type":"String","value":"'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE65381FFFFFFFFFFFFFFFF'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"bad_dh"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createDiffieHellman"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"p"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"bad_dh"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"verifyError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"DH_NOT_SUITABLE_GENERATOR"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"availableCurves"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"new"},{"type":"Identifier","value":"Set"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getCurves"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"availableHashes"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"new"},{"type":"Identifier","value":"Set"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getHashes"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"availableCurves"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":"("},{"type":"String","value":"'Oakley-EC2N-3'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createECDH"},{"type":"Punctuator","value":"("},{"type":"String","value":"'Oakley-EC2N-3'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createHash"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"availableCurves"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":"("},{"type":"String","value":"'prime256v1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"availableCurves"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":"("},{"type":"String","value":"'secp256k1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createECDH"},{"type":"Punctuator","value":"("},{"type":"String","value":"'prime256v1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ecdh2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createECDH"},{"type":"Punctuator","value":"("},{"type":"String","value":"'prime256v1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"key1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"key2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"ecdh2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"secret1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key2"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'base64'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"secret2"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"ecdh2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key1"},{"type":"Punctuator","value":","},{"type":"String","value":"'latin1'"},{"type":"Punctuator","value":","},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"secret1"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"String","value":"'base64'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":","},{"type":"String","value":"'uncompressed'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"4"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"firstByte"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":","},{"type":"String","value":"'compressed'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"firstByte"},{"type":"Punctuator","value":"==="},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":"||"},{"type":"Identifier","value":"firstByte"},{"type":"Punctuator","value":"==="},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"firstByte"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hybrid'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"firstByte"},{"type":"Punctuator","value":"==="},{"type":"Numeric","value":"6"},{"type":"Punctuator","value":"||"},{"type":"Identifier","value":"firstByte"},{"type":"Punctuator","value":"==="},{"type":"Numeric","value":"7"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"expectsError"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"10"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"code"},{"type":"Punctuator","value":":"},{"type":"String","value":"'ERR_CRYPTO_ECDH_INVALID_FORMAT'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"TypeError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":":"},{"type":"String","value":"'Invalid ECDH format: 10'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ecdh3"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createECDH"},{"type":"Punctuator","value":"("},{"type":"String","value":"'secp256k1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"key3"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"ecdh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"expectsError"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Identifier","value":"ecdh2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key3"},{"type":"Punctuator","value":","},{"type":"String","value":"'latin1'"},{"type":"Punctuator","value":","},{"type":"String","value":"'buffer'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"code"},{"type":"Punctuator","value":":"},{"type":"String","value":"'ERR_CRYPTO_ECDH_INVALID_PUBLIC_KEY'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":":"},{"type":"String","value":"'Public key is not valid for specified curve'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ecdh4"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createECDH"},{"type":"Punctuator","value":"("},{"type":"String","value":"'prime256v1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"ecdh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"ecdh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPublicKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"ecdh4"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPublicKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh3"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"RegularExpression","value":"/^Error: Failed to convert Buffer to EC_POINT$/","regex":{"pattern":"^Error: Failed to convert Buffer to EC_POINT$","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createECDH"},{"type":"Punctuator","value":"("},{"type":"String","value":"'secp256k1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"RegularExpression","value":"/^Error: Failed to get ECDH public key$/","regex":{"pattern":"^Error: Failed to get ECDH public key$","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"RegularExpression","value":"/^Error: Failed to get ECDH private key$/","regex":{"pattern":"^Error: Failed to get ECDH private key$","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cafebabeKey"},{"type":"Punctuator","value":"="},{"type":"String","value":"'cafebabe'"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"repeat"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"8"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cafebabePubPtComp"},{"type":"Punctuator","value":"="},{"type":"String","value":"'03672a31bfc59d3f04548ec9b7daeeba2f61814e8ccc40448045007f5479f693a3'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cafebabePubPtUnComp"},{"type":"Punctuator","value":"="},{"type":"String","value":"'04672a31bfc59d3f04548ec9b7daeeba2f61814e8ccc40448045007f5479f693a3'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'2e02c7f93d13dc2732b760ca377a5897b9dd41a1c1b29dc0442fdce6d0a04d1d'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cafebabeKey"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabeKey"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabePubPtUnComp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"peerPubPtComp"},{"type":"Punctuator","value":"="},{"type":"String","value":"'02c6b754b20826eb925e052ee2c25285b162b51fdca732bcf67e39d647fb6830ae'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"peerPubPtUnComp"},{"type":"Punctuator","value":"="},{"type":"String","value":"'04c6b754b20826eb925e052ee2c25285b162b51fdca732bcf67e39d647fb6830ae'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'b651944a574a362082a77e3f2b5d9223eb54d7f2f76846522bf75f3bedb8178e'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"sharedSecret"},{"type":"Punctuator","value":"="},{"type":"String","value":"'1da220b5329bbe8bfd19ceef5a5898593f411a6f12ea40f2a8eead9a5cf59970'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"peerPubPtComp"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"sharedSecret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"peerPubPtUnComp"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"sharedSecret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabeKey"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabePubPtUnComp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPublicKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cafebabePubPtComp"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabePubPtUnComp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'compressed'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabePubPtComp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPublicKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cafebabePubPtUnComp"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabePubPtUnComp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'compressed'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabePubPtComp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPublicKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"peerPubPtComp"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPublicKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"peerPubPtUnComp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"peerPubPtComp"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"RegularExpression","value":"/^Error: Invalid key pair$/","regex":{"pattern":"^Error: Invalid key pair$","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cafebabeKey"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"errMessage"},{"type":"Punctuator","value":"="},{"type":"RegularExpression","value":"/^Error: Private key is not valid for specified curve\\.$/","regex":{"pattern":"^Error: Private key is not valid for specified curve\\.$","flags":""}},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"["},{"type":"String","value":"'0000000000000000000000000000000000000000000000000000000000000000'"},{"type":"Punctuator","value":","},{"type":"String","value":"'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141'"},{"type":"Punctuator","value":","},{"type":"String","value":"'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"forEach"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"element"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"throws"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setPrivateKey"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"element"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"errMessage"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"assert"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"strictEqual"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecdh5"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getPrivateKey"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cafebabeKey"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"availableCurves"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":"("},{"type":"String","value":"'prime256v1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"availableHashes"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"curve"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createECDH"},{"type":"Punctuator","value":"("},{"type":"String","value":"'prime256v1'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"invalidKey"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"alloc"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"65"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"invalidKey"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"fill"},{"type":"Punctuator","value":"("},{"type":"String","value":"'\\0'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"curve"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"generateKeys"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"expectsError"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Identifier","value":"curve"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"computeSecret"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"invalidKey"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"code"},{"type":"Punctuator","value":":"},{"type":"String","value":"'ERR_CRYPTO_ECDH_INVALID_PUBLIC_KEY'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"Error"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":":"},{"type":"String","value":"'Public key is not valid for specified curve'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"ecPrivateKey"},{"type":"Punctuator","value":"="},{"type":"String","value":"'-----BEGIN EC PRIVATE KEY-----\\n'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'MHcCAQEEIF+jnWY1D5kbVYDNvxxo/Y+ku2uJPDwS0r/VuPZQrjjVoAoGCCqGSM49\\n'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'AwEHoUQDQgAEurOxfSxmqIRYzJVagdZfMMSjRNNhB8i3mXyIMq704m2m52FdfKZ2\\n'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'pQhByd5eyj3lgZ7m7jbchtdgyOF8Io/1ng==\\n'"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'-----END EC PRIVATE KEY-----'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSign"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SHA256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"sign"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"ecPrivateKey"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"common"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"expectsError"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createECDH"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"code"},{"type":"Punctuator","value":":"},{"type":"String","value":"'ERR_INVALID_ARG_TYPE'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"TypeError"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":":"},{"type":"String","value":"'The \"curve\" argument must be of type string. '"},{"type":"Punctuator","value":"+"},{"type":"String","value":"'Received type undefined'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"}]
[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"describe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sanitizeUri'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"sanitizeUriProvider"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"beforeEach"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"module"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"_$$sanitizeUriProvider_"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"sanitizeUriProvider"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"_$$sanitizeUriProvider_"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"inject"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"$$sanitizeUri"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"uri"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"$$sanitizeUri"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"uri"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"uri"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"$$sanitizeUri"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"uri"},{"type":"Punctuator","value":","},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"isEvilInCurrentBrowser"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"uri"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"a"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"window"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"document"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createElement"},{"type":"Punctuator","value":"("},{"type":"String","value":"'a'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"a"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setAttribute"},{"type":"Punctuator","value":"("},{"type":"String","value":"'href'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"uri"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"a"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"href"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"substring"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"4"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"!=="},{"type":"String","value":"'http'"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"describe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'img[src] sanitization'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize javascript: urls'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize javascript: urls with comments'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:alert(1)//data:image/'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:alert(1)//data:image/'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize non-image data: urls'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'data:application/javascript;charset=US-ASCII,alert(\\'evil!\\');'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:data:application/javascript;charset=US-ASCII,alert(\\'evil!\\');'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'data:,foo'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:data:,foo'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize mailto: urls'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'mailto:foo@bar.com'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:mailto:foo@bar.com'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize obfuscated javascript: urls'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'JaVaScRiPt:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'java\\u0009script:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"isEvilInCurrentBrowser"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toEqual"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"' javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"' \\u000e javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"isEvilInCurrentBrowser"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toEqual"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:doEvilStuff(); http://make.me/look/good'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeOneOf"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff(); http://make.me/look/good'"},{"type":"Punctuator","value":","},{"type":"String","value":"'unsafe:javascript:doEvilStuff();%20http://make.me/look/good'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize ng-src bindings as well'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should not sanitize valid urls'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'/foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'/foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'../foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'#foo'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'#foo'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'http://foo.com/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'http://foo.com/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"' http://foo.com/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"' http://foo.com/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'https://foo.com/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'https://foo.com/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'ftp://foo.com/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'ftp://foo.com/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'file:///foo/bar.html'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'file:///foo/bar.html'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should not sanitize blob urls'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'blob:///foo/bar.html'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'blob:///foo/bar.html'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should not sanitize data: URIs for images'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=='"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=='"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should allow reconfiguration of the src whitelist'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"returnVal"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeUriProvider"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"imgSrcSanitizationWhitelist"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"RegExp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"returnVal"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"sanitizeUriProvider"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"imgSrcSanitizationWhitelist"},{"type":"Punctuator","value":"("},{"type":"RegularExpression","value":"/javascript:/","regex":{"pattern":"javascript:","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"returnVal"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeUriProvider"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'http://recon/figured'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeImg"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:http://recon/figured'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"describe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'a[href] sanitization'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize javascript: urls'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"inject"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize data: urls'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"inject"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'data:evilPayload'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:data:evilPayload'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize obfuscated javascript: urls'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"inject"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'JaVaScRiPt:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'java\\u0009script:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"isEvilInCurrentBrowser"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toEqual"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"' javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"' \\u000e javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"isEvilInCurrentBrowser"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toEqual"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:doEvilStuff(); http://make.me/look/good'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeOneOf"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff(); http://make.me/look/good'"},{"type":"Punctuator","value":","},{"type":"String","value":"'unsafe:javascript:doEvilStuff();%20http://make.me/look/good'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should sanitize ngHref bindings as well'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"inject"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should not sanitize valid urls'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"inject"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'/foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'/foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'../foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'#foo'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'#foo'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'http://foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'http://foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"' http://foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"' http://foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'https://foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'https://foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'ftp://foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'ftp://foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'sftp://foo/bar'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sftp://foo/bar'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'mailto:foo@bar.com'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'mailto:foo@bar.com'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'file:///foo/bar.html'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'file:///foo/bar.html'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'should allow reconfiguration of the href whitelist'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"function"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"var"},{"type":"Identifier","value":"returnVal"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeUriProvider"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"aHrefSanitizationWhitelist"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"instanceof"},{"type":"Identifier","value":"RegExp"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"returnVal"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"sanitizeUriProvider"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"aHrefSanitizationWhitelist"},{"type":"Punctuator","value":"("},{"type":"RegularExpression","value":"/javascript:/","regex":{"pattern":"javascript:","flags":""}},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"returnVal"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeUriProvider"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'javascript:doEvilStuff()'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'javascript:doEvilStuff()'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":"="},{"type":"String","value":"'http://recon/figured'"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"sanitizeHref"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"testUrl"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'unsafe:http://recon/figured'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"}]
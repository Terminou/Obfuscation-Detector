[{"type":"String","value":"'use strict'"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'crypto'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"net"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"("},{"type":"String","value":"'net'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"exports"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"ccs"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'140303000101'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"class"},{"type":"Identifier","value":"TestTLSSocket"},{"type":"Keyword","value":"extends"},{"type":"Identifier","value":"net"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"Socket"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"constructor"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"server_cert"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"super"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"server_cert"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"server_cert"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"version"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0303'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"handshake_list"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"ciphers"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'000002009c0'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"pre_master_secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"version"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"randomBytes"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"46"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"master_secret"},{"type":"Punctuator","value":"="},{"type":"Null","value":"null"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"write_seq"},{"type":"Punctuator","value":"="},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client_random"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"randomBytes"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"32"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'handshake'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"handshake_list"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"push"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'server_random'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"server_random"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"master_secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"PRF12"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha256'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"pre_master_secret"},{"type":"Punctuator","value":","},{"type":"String","value":"'master secret'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client_random"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"server_random"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"48"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"key_block"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"PRF12"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha256'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"master_secret"},{"type":"Punctuator","value":","},{"type":"String","value":"'key expansion'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"server_random"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client_random"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"40"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client_writeKey"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"key_block"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"16"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client_writeIV"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"key_block"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"32"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"36"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"createClientHello"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"compressions"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0100'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"addHandshakeHeader"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0x01"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"version"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client_random"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"ciphers"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"compressions"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"emit"},{"type":"Punctuator","value":"("},{"type":"String","value":"'handshake'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"addRecordHeader"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0x16"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"createClientKeyExchange"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"encrypted_pre_master_secret"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"publicEncrypt"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":":"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"server_cert"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"padding"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"constants"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"RSA_PKCS1_PADDING"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"pre_master_secret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"alloc"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"writeUIntBE"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"encrypted_pre_master_secret"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"addHandshakeHeader"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0x10"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encrypted_pre_master_secret"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"emit"},{"type":"Punctuator","value":"("},{"type":"String","value":"'handshake'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"addRecordHeader"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0x16"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"createFinished"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"shasum"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createHash"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha256'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"shasum"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"handshake_list"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"message_hash"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"shasum"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"digest"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"r"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"PRF12"},{"type":"Punctuator","value":"("},{"type":"String","value":"'sha256'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"master_secret"},{"type":"Punctuator","value":","},{"type":"String","value":"'client finished'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"message_hash"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"12"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"addHandshakeHeader"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0x14"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"r"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"emit"},{"type":"Punctuator","value":"("},{"type":"String","value":"'handshake'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"addRecordHeader"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0x16"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"createIllegalHandshake"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"illegal_handshake"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"alloc"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"5"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"addRecordHeader"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0x16"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"illegal_handshake"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"parseTLSFrame"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"="},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"record"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"5"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"record"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"record"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"5"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readUInt16BE"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"+="},{"type":"Numeric","value":"5"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"remaining"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":"==="},{"type":"Numeric","value":"0x16"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"do"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"remaining"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"parseTLSHandshake"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"remaining"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"while"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"remaining"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":">"},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"+="},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"parseTLSHandshake"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"="},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"handshake_type"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"handshake_type"},{"type":"Punctuator","value":"==="},{"type":"Numeric","value":"0x02"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"server_random"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"6"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"6"},{"type":"Punctuator","value":"+"},{"type":"Numeric","value":"32"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"emit"},{"type":"Punctuator","value":"("},{"type":"String","value":"'server_random'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"server_random"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"+="},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readUIntBE"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"+="},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"handshake"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"emit"},{"type":"Punctuator","value":"("},{"type":"String","value":"'handshake'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"handshake"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":"+="},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"remaining"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"buf"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"offset"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"remaining"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"encrypt"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"version"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"nonce"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"randomBytes"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"8"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"iv"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client_writeIV"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"4"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"nonce"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createCipheriv"},{"type":"Punctuator","value":"("},{"type":"String","value":"'aes-128-gcm'"},{"type":"Punctuator","value":","},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"client_writeKey"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"iv"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"write_seq"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"alloc"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"8"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"write_seq"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"writeUInt32BE"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"this"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"write_seq"},{"type":"Punctuator","value":"++"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"4"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"aad"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"write_seq"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"5"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"setAAD"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"aad"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"encrypted1"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"plain"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"slice"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"5"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"encrypted"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"encrypted1"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"final"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"tag"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"bob"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"getAuthTag"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"alloc"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"writeUInt16BE"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"nonce"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"encrypted"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"tag"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"version"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"nonce"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"encrypted"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"tag"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"addRecordHeader"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"frame"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"record_layer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"String","value":"'0003030000'"},{"type":"Punctuator","value":","},{"type":"String","value":"'hex'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"record_layer"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"record_layer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"writeUInt16BE"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"frame"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"record_layer"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"frame"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"addHandshakeHeader"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"handshake_header"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"alloc"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"4"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"handshake_header"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"type"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"handshake_header"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"writeUIntBE"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"handshake_header"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"PRF12"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"algo"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"label"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"seed"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"newSeed"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"concat"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"from"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"label"},{"type":"Punctuator","value":","},{"type":"String","value":"'utf8'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"seed"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"P_hash"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"algo"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"newSeed"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"P_hash"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"algo"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"seed"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"result"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"Buffer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"alloc"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createHmac"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"algo"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"seed"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"a"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"digest"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"j"},{"type":"Punctuator","value":"="},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"while"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"j"},{"type":"Punctuator","value":"<"},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createHmac"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"algo"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"a"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"seed"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"b"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"digest"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"todo"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"b"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"length"},{"type":"Punctuator","value":";"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"j"},{"type":"Punctuator","value":"+"},{"type":"Identifier","value":"todo"},{"type":"Punctuator","value":">"},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"todo"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"size"},{"type":"Punctuator","value":"-"},{"type":"Identifier","value":"j"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"b"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"copy"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"result"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"j"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"todo"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"j"},{"type":"Punctuator","value":"+="},{"type":"Identifier","value":"todo"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"crypto"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createHmac"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"algo"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"secret"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"update"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"a"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Identifier","value":"a"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"hmac"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"digest"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"result"},{"type":"Punctuator","value":";"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"exports"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"TestTLSSocket"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"TestTLSSocket"},{"type":"Punctuator","value":";"}]
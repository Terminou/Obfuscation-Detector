[{"type":"Keyword","value":"import"},{"type":"Identifier","value":"LRU"},{"type":"Identifier","value":"from"},{"type":"String","value":"'lru-cache'"},{"type":"Keyword","value":"import"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"compileWithWebpack"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"from"},{"type":"String","value":"'./compile-with-webpack'"},{"type":"Keyword","value":"import"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createBundleRenderer"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"from"},{"type":"String","value":"'../../packages/vue-server-renderer'"},{"type":"Keyword","value":"import"},{"type":"Identifier","value":"VueSSRServerPlugin"},{"type":"Identifier","value":"from"},{"type":"String","value":"'../../packages/vue-server-renderer/server-plugin'"},{"type":"Keyword","value":"export"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"file"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Keyword","value":"typeof"},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"==="},{"type":"String","value":"'function'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"options"},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"undefined"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"!"},{"type":"Punctuator","value":"!"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"&&"},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"if"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"delete"},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"asBundle"},{"type":"Identifier","value":"compileWithWebpack"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"file"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"target"},{"type":"Punctuator","value":":"},{"type":"String","value":"'node'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"devtool"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":"?"},{"type":"String","value":"'#source-map'"},{"type":"Punctuator","value":":"},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"output"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"path"},{"type":"Punctuator","value":":"},{"type":"String","value":"'/'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"filename"},{"type":"Punctuator","value":":"},{"type":"String","value":"'bundle.js'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"libraryTarget"},{"type":"Punctuator","value":":"},{"type":"String","value":"'commonjs2'"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"externals"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"require"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"resolve"},{"type":"Punctuator","value":"("},{"type":"String","value":"'../../dist/vue.runtime.common.js'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"plugins"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":"?"},{"type":"Punctuator","value":"["},{"type":"Keyword","value":"new"},{"type":"Identifier","value":"VueSSRServerPlugin"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"fs"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"bundle"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":"?"},{"type":"Identifier","value":"JSON"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"parse"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"fs"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readFileSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'/vue-ssr-server-bundle.json'"},{"type":"Punctuator","value":","},{"type":"String","value":"'utf-8'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"fs"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"readFileSync"},{"type":"Punctuator","value":"("},{"type":"String","value":"'/bundle.js'"},{"type":"Punctuator","value":","},{"type":"String","value":"'utf-8'"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"createBundleRenderer"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"bundle"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"describe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'SSR: bundle renderer'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createAssertions"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"createAssertions"},{"type":"Punctuator","value":"("},{"type":"Boolean","value":"false"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"function"},{"type":"Identifier","value":"createAssertions"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'app.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":":"},{"type":"String","value":"'/test'"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'<div data-server-rendered=\"true\">/test</div>'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hello'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToStream'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'app.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":":"},{"type":"String","value":"'/test'"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToStream"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"="},{"type":"String","value":"''"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'data'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"chunk"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"+="},{"type":"Identifier","value":"chunk"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'end'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'<div data-server-rendered=\"true\">/test</div>'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hello'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString catch error'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString catch Promise rejection'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'promise-rejection.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToStream catch error'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToStream"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToStream catch Promise rejection'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'promise-rejection.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToStream"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'render with cache (get/set)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"jasmine"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSpy"},{"type":"Punctuator","value":"("},{"type":"String","value":"'get'"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"jasmine"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSpy"},{"type":"Punctuator","value":"("},{"type":"String","value":"'set'"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"setTimeout"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'cache.js'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":"="},{"type":"String","value":"'<div data-server-rendered=\"true\">/test</div>'"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"="},{"type":"String","value":"'app::1'"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toHaveBeenCalledWith"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"setArgs"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"argsFor"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"setArgs"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"setArgs"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"html"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"html"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'render with cache (get/set/has)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"jasmine"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSpy"},{"type":"Punctuator","value":"("},{"type":"String","value":"'has'"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"jasmine"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSpy"},{"type":"Punctuator","value":"("},{"type":"String","value":"'get'"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"jasmine"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSpy"},{"type":"Punctuator","value":"("},{"type":"String","value":"'set'"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"!"},{"type":"Punctuator","value":"!"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"return"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'cache.js'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":"="},{"type":"String","value":"'<div data-server-rendered=\"true\">/test</div>'"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"="},{"type":"String","value":"'app::1'"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toHaveBeenCalledWith"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"not"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toHaveBeenCalled"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"setArgs"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"argsFor"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"setArgs"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"setArgs"},{"type":"Punctuator","value":"["},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"html"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"html"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"has"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'render with cache (nested)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"="},{"type":"Keyword","value":"new"},{"type":"Identifier","value":"LRU"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"maxAge"},{"type":"Punctuator","value":":"},{"type":"Identifier","value":"Infinity"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"spyOn"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":","},{"type":"String","value":"'get'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"and"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"callThrough"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"spyOn"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":","},{"type":"String","value":"'set'"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"and"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"callThrough"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'nested-cache.js'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":"="},{"type":"String","value":"'<div data-server-rendered=\"true\">/test</div>'"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"="},{"type":"String","value":"'app::1'"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"context1"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"registered"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"context2"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"registered"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"["},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context1"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cached"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cached"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"html"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"1"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context1"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"registered"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toEqual"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"String","value":"'app'"},{"type":"Punctuator","value":","},{"type":"String","value":"'child'"},{"type":"Punctuator","value":","},{"type":"String","value":"'grandchild'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context2"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"3"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"calls"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"count"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Numeric","value":"2"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context2"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"registered"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toEqual"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"["},{"type":"String","value":"'app'"},{"type":"Punctuator","value":","},{"type":"String","value":"'child'"},{"type":"Punctuator","value":","},{"type":"String","value":"'grandchild'"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'render with cache (opt-out)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"jasmine"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSpy"},{"type":"Punctuator","value":"("},{"type":"String","value":"'get'"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"jasmine"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"createSpy"},{"type":"Punctuator","value":"("},{"type":"String","value":"'set'"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"setTimeout"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"cb"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Numeric","value":"0"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":":"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"cache"},{"type":"Punctuator","value":"["},{"type":"Identifier","value":"key"},{"type":"Punctuator","value":"]"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"val"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'cache-opt-out.js'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"options"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":"="},{"type":"String","value":"'<div data-server-rendered=\"true\">/test</div>'"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"not"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toHaveBeenCalled"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"not"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toHaveBeenCalled"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"expected"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"get"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"not"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toHaveBeenCalled"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"set"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"not"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toHaveBeenCalled"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString (bundle format with code split)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'split.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":":"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":":"},{"type":"String","value":"'/test'"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBeNull"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'<div data-server-rendered=\"true\">/test<div>async test.woff2 test.png</div></div>'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToStream (bundle format with code split)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'split.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":":"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":":"},{"type":"String","value":"'/test'"},{"type":"Punctuator","value":"}"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToStream"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":")"},{"type":"Keyword","value":"let"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"="},{"type":"String","value":"''"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'data'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"chunk"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"+="},{"type":"Identifier","value":"chunk"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'end'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'<div data-server-rendered=\"true\">/test<div>async test.woff2 test.png</div></div>'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString catch error (bundle format with source map)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":":"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"stack"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toContain"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test/ssr/fixtures/error.js:1:6'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString catch error (bundle format with source map)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"asBundle"},{"type":"Punctuator","value":":"},{"type":"Boolean","value":"true"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"="},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToStream"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"stream"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"on"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"stack"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toContain"},{"type":"Punctuator","value":"("},{"type":"String","value":"'test/ssr/fixtures/error.js:1:6'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString return Promise'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'app.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Keyword","value":"const"},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"="},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"url"},{"type":"Punctuator","value":":"},{"type":"String","value":"'/test'"},{"type":"Punctuator","value":"}"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"then"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"res"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'<div data-server-rendered=\"true\">/test</div>'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"context"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"msg"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'hello'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString return Promise (error)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'error.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Keyword","value":"catch"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"it"},{"type":"Punctuator","value":"("},{"type":"String","value":"'renderToString return Promise (Promise rejection)'"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"createRenderer"},{"type":"Punctuator","value":"("},{"type":"String","value":"'promise-rejection.js'"},{"type":"Punctuator","value":","},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"runInNewContext"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":","},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"renderer"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"renderToString"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Keyword","value":"catch"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"=>"},{"type":"Punctuator","value":"{"},{"type":"Identifier","value":"expect"},{"type":"Punctuator","value":"("},{"type":"Identifier","value":"err"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"message"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"."},{"type":"Identifier","value":"toBe"},{"type":"Punctuator","value":"("},{"type":"String","value":"'foo'"},{"type":"Punctuator","value":")"},{"type":"Identifier","value":"done"},{"type":"Punctuator","value":"("},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"},{"type":"Punctuator","value":")"},{"type":"Punctuator","value":"}"}]